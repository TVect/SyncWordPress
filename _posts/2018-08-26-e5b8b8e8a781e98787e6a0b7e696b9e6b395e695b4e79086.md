---
ID: 318
post_title: 常见采样方法整理
author: Chin
post_excerpt: ""
layout: post
permalink: 'http://blog.tvect.cc/2018/08/26/%e5%b8%b8%e8%a7%81%e9%87%87%e6%a0%b7%e6%96%b9%e6%b3%95%e6%95%b4%e7%90%86/'
published: true
post_date: 2018-08-26 22:27:40
---
[toc]

挖了坑，打算最近总结一下机器学习中常用的采样方法。主要参考资料为 PRML 的第 11 章 Sampling Methods.

<!--more-->

<h1>Introduction</h1>

目的是要 evaluate $$ E[f] = \int_{p(z)} f(z) dz = \int f(z) p(z) dz$$,

在离散变量的情形，积分号替换为求和号.

假定这个期望很复杂，不能通过解析的方法简单求解.

一般做法, 是从分布 $$p(z)$$ 中采样一些样本，用 $$ \hat{f} = \frac{1}{L} \sum_{i=1}^{L} f(z_{i}) $$ 去逼近 $$E(f)$$

问题在于，在采样过程中，样本可能并不是独立的

<h1>Methods</h1>

<h2>Basic Transformation Methods</h2>

假设可以由计算机得到 $$(0,1)$$ 均匀分布的随机数z，现在想得到服从任意分布p(y)的随机数y的样本，其中假定 $$y=f(z)$$。
概率密度变量转换时，为了保证概率相等，要求 $$p(z)dz~=p(y)dy$$，当然概率密度必须是正的，所以有下式：$$ p(y)=p(z)|\frac{dz}{dy}| $$

为了能得到特定的分布，只要能找到相应的函数 $$f$$ 即可.

对上式两边求积分: $$ z = \int_{-\inf}^{y} p(y) dy = h(y) $$, 取 $$f = h^{-1}$$, 也即 $$y$$ 的累积分布函数的逆，即可.

类似的，在多变量的情况下有：$$ p(y_1, ..., y_m) = p(z_1, ..., z_m) | \frac{\partial (z_1, ..., z_m) }{\partial (y_1, ..., y_m)} |$$

例子: 指数分布，柯西分布，正态分布

这种方法需要对指定分布求无穷积分，只能适用于一些简单的分布。

<h2>rejection sampling</h2>

假定现在要采样的分布是一个相对比较复杂的分布 $$p(z)$$, 很难直接采样，但是可以对给定的 $$z$$，求出未归一化的概率值 $$p(z) = \frac{1}{Z_p}\tilde{p}(z) $$

做拒绝采样的时候，需要一个 proposal distribution q(z), 这个分布相比之下，更简单，可以直接从中采样。另外有一个 contant $$k$$ 满足 $$ k q(z) > \tilde{p}(z) $$。拒绝采样的流程如下:

<ol>
<li>从分布 $$q(z)$$ 中采样一个 $$z_0$$.</p></li>
<li><p>在 $$[0, kq(z_0)]$$ 中做均匀采样，得到一个数 $$u_0$$. 如果 $$u_0 > \tilde{p}(z_0)$$ 就拒绝样本, 反之接受样本 $$z_0$$.</p></li>
</ol>

<p>要证明 rejection sampling 的有效性，只要证明 $$Q(z|accept) = \frac{q(z) Q(accept|z)}{Q(accept)} = p(z)$$ 即可. 这个等式是很显然的。

<h3>Adaptive rejection sampling</h3>

在基本的拒绝采样方法中，constant $$k$$ 的选取要很小心，$$k$$ 应该在满足 $$kq(z) > \tilde{p}(z)$$ 的约束下，要尽量小，以使得拒绝率不要太大。

所以，这就为 proposal distribution 的选取带来了难度，它应该尽量不要和待采样的分布差距太大。

在 $$p(z)$$ 是 log concave 的情况下，可以 adaptive 的构造一个 proposal distribution，进一步得到符合所需分布的样本。具体流程如下：

<ol>
<li>取一个初始的网格点集合, 在集合中每个点处，构造一个 $$log p(x)$$的切线，这些切线连起来就构成了 $$log p(x)$$ 的一个 piece-wise linear upper bound $$u(x)$$.</p></li>
<li><p>对 $$u(x)$$ 做 exp，再概率归一化. 即得到一个概率分布 $$ s(x) = \frac{\exp u(x)}{\int \exp u(z) dz} $$. 这是一个 piece-wise exponential distribution。 <strong>分段指数分布</strong> 可以使用 Basic Transformation Methods 进行采样。</p></li>
<li><p>把上面的分段指数分布当做 proposal distribution， 使用 rejection sampling 技术, 此时的 constant k 为 $$\int \exp u(z) dz$$。

如果采样出来的点, 被拒绝了，就把该点再加到前面的网格点集合中，进一步得到新的 proposal distribution.  随着网格点的增多，proposal distribution 会和 $$p(x)$$ 越来越近似，拒绝率也会越来越低.</p></li>
</ol>

<p><strong>弱点</strong>

PRML Page-531 中，用正态分布的例子说明了在高维的情况下，即使 comparison function 和 required distribution 很接近，也会导出一个很低的接受率。

Furthermore, the exponential decrease of acceptance rate with dimensionality is a generic feature of rejection sampling.

所以，拒绝采样并不太适合于高维分布。

<h2>importance sampling</h2>

<h2>Markov Chain Monto Carlo</h2>

<h3>Metropolis-Hastings algorithm</h3>

<h3>Gibbs Sampling</h3>

<h2>Slice Sampling</h2>

<h1>Reference</h1>

<ul>
<li>PRML chapter 11. SAMPLING METHODS</li>
</ul>